# 观测计划调度器可视化工具 - 使用说明

## 📦 程序文件

### GUI界面程序
- **文件名**: `观测计划调度器.exe`
- **大小**: 约11MB
- **功能**: 图形化界面，支持配置文件加载、参数设置、可视化生成

### Python源文件
- `observation_scheduler_tkinter_gui.py` - GUI界面源代码
- `observation_scheduler_visualizer.py` - 基础可视化器
- `observation_visualizer_advanced.py` - 高级可视化器

## 🚀 快速开始

### 1. 运行程序
双击 `dist/观测计划调度器.exe` 即可启动GUI界面

### 2. 使用步骤
1. **选择配置文件**
   - 点击"浏览..."按钮选择YAML格式的配置文件
   - 点击"加载"按钮加载配置

2. **设置参数**
   - **输出格式**: 选择Markdown、HTML或两者都生成
   - **使用颜色**: 是否在甘特图中使用颜色
   - **显示滤镜详情**: 是否显示详细的滤镜信息
   - **自动打开浏览器**: 生成HTML后是否自动打开浏览器

3. **生成可视化**
   - 点击"生成可视化"按钮
   - 程序会在后台生成结果

4. **查看结果**
   - **甘特图标签页**: 查看mermaid甘特图代码
   - **摘要信息标签页**: 查看观测计划统计信息
   - **配置预览标签页**: 查看当前配置文件内容

## 📁 输出文件

生成的文件会自动保存到 `reports` 目录：
- `gantt_YYYYMMDD_HHMMSS.md` - Markdown格式的甘特图
- `report_YYYYMMDD_HHMMSS.html` - HTML格式的完整报告

## ⚙️ 配置文件格式

配置文件应为YAML格式，包含观测目标、滤镜设置、时间窗口等信息。

示例配置结构：
```yaml
targets:
  - name: "目标1"
    ra: "12:34:56"
    dec: "+78:90:12"
    priority: 1
    filters:
      - name: "L"
        exposure_time: 300
        count: 10
      - name: "R"
        exposure_time: 180
        count: 5
observation_window:
  start: "2024-01-01T20:00:00"
  end: "2024-01-02T06:00:00"
```

## 🛠️ 技术特点

- **独立运行**: 无需安装Python环境
- **多线程**: 界面响应流畅，生成过程不卡顿
- **错误处理**: 完善的异常处理和用户提示
- **中文界面**: 完全中文化的用户界面

## 📞 支持

如遇到问题，请检查：
1. 配置文件格式是否正确
2. 是否有写入权限
3. 系统是否支持tkinter（Windows系统通常都支持）

## 🔧 构建说明

如需重新构建exe文件：
```bash
pyinstaller --onefile --windowed --name="观测计划调度器" observation_scheduler_tkinter_gui.py
```

---

**版本**: 1.0  
**构建时间**: 2024年11月30日