# ACPClient 图形化配置编辑器

图形化配置编辑器是ACPClient项目的重要组成部分，提供了一个直观、易用的界面来创建和编辑观测配置文件。

## 功能特性

### 🎯 核心功能
- **多标签页界面**：将复杂的配置分为多个逻辑清晰的标签页
- **图形化目标管理**：通过列表和对话框管理观测目标
- **实时配置验证**：输入时即时验证，避免配置错误
- **模板系统**：提供预设模板，快速创建常用配置
- **文件操作**：支持新建、打开、保存、另存为、导出JSON

### 📋 配置标签页

#### 1. 常规设置
- 全局停止时间设置
- 配置信息显示
- 快速时间操作按钮

#### 2. 服务器配置
- ACP服务器URL设置
- 用户名和密码配置
- 连接测试功能

#### 3. 观测目标
- 目标列表显示
- 添加/编辑/删除目标
- 目标优先级管理
- 目标顺序调整

#### 4. 中天反转
- 中天前停止时间
- 中天后恢复时间
- 安全边距设置
- 详细说明信息

#### 5. 观测站信息
- 经纬度坐标设置
- 常用观测站快速选择
- 坐标验证

#### 6. 全局设置
- 抖动范围设置
- 自动对焦开关
- 对焦间隔时间
- 试运行模式

## 使用方法

### 启动配置编辑器

#### 方法1：通过主GUI启动
1. 启动ACPClient主GUI
2. 切换到"观测控制"标签页
3. 点击"图形化配置编辑器"按钮

#### 方法2：运行演示程序
```bash
cd e:\ACPClient
python app\config_editor_demo.py
```

#### 方法3：独立使用
```python
from app.gui.config_editor import ConfigEditorAdvanced
import tkinter as tk

root = tk.Tk()
editor = ConfigEditorAdvanced(root, "path/to/config.yaml")
editor.pack(fill=tk.BOTH, expand=True)
root.mainloop()
```

### 基本操作

#### 文件操作
1. **新建配置**：点击工具栏"新建"按钮
2. **打开配置**：点击"打开"按钮选择YAML文件
3. **保存配置**：点击"保存"按钮
4. **另存为**：点击"另存为"按钮保存到新文件

#### 编辑观测目标
1. **添加目标**：
   - 切换到"观测目标"标签页
   - 点击"添加目标"按钮
   - 在对话框中填写目标信息
   - 点击"确定"保存

2. **编辑目标**：
   - 在目标列表中选择要编辑的目标
   - 点击"编辑目标"按钮或双击目标
   - 修改目标信息
   - 点击"确定"保存

3. **删除目标**：
   - 选择要删除的目标
   - 点击"删除目标"按钮
   - 确认删除操作

#### 使用模板
1. 点击工具栏"加载模板"按钮
2. 选择需要的模板类型：
   - **基础观测**：适合一般的观测任务
   - **深空观测**：针对深空天体优化
   - **行星观测**：针对行星观测优化
3. 模板会自动填充到编辑器中
4. 根据需要修改具体参数

#### 配置验证
1. 点击工具栏"验证配置"按钮
2. 系统会检查以下项目：
   - 服务器URL是否有效
   - 观测目标是否完整
   - 坐标格式是否正确
   - 滤镜配置是否存在
3. 查看验证结果和错误提示
4. 根据提示修正配置

## 界面说明

### 主界面布局
```
┌─────────────────────────────────────────────────────────────┐
│  文件操作    配置操作    帮助                          │
├─────────────────────────────────────────────────────────────┤
│  常规  服务器  观测目标  中天反转  观测站  全局设置  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│                    配置内容区域                             │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│  状态栏                                               │
└─────────────────────────────────────────────────────────────┘
```

### 目标编辑对话框
- **基本信息**：名称、坐标、开始时间、优先级
- **滤镜配置**：添加和管理观测滤镜
- **常用目标**：快速选择预设天体
- **坐标验证**：确保坐标格式正确

### 输入验证
- **坐标格式**：HH:MM:SS 或 +/-DD:MM:SS
- **时间格式**：YYYY-MM-DD HH:MM:SS
- **数值范围**：优先级1-10，曝光时间>0等
- **必填字段**：目标名称、坐标、滤镜配置

## 配置模板

### 基础观测模板
适合一般的观测任务，包含：
- 基本的服务器配置
- 单个观测目标
- 标准LRGB滤镜设置
- 默认的观测参数

### 深空观测模板
针对深空天体优化，包含：
- 窄带滤镜配置（H-alpha、OIII、SII）
- 较长的曝光时间
- 中天反转保护
- 自动对焦设置

### 行星观测模板
针对行星观测优化，包含：
- 短曝光时间
- 高帧率拍摄
- 减少的抖动范围
- 禁用的自动对焦

## 高级功能

### 批量操作
- 支持多个目标的批量添加
- 目标顺序的拖拽调整
- 滤镜配置的批量修改

### 导入/导出
- **YAML格式**：原生配置文件格式
- **JSON格式**：便于与其他工具交互
- **模板保存**：保存自定义配置为模板

### 实时预览
- 配置修改时实时更新预览
- 目标列表的动态更新
- 配置信息的实时显示

## 故障排除

### 常见问题

#### 1. 无法打开配置文件
**问题**：选择配置文件后没有反应
**解决**：
- 检查文件是否为有效的YAML格式
- 确认文件编码为UTF-8
- 查看错误日志获取详细信息

#### 2. 坐标验证失败
**问题**：输入坐标后提示格式错误
**解决**：
- 确保使用正确的格式：HH:MM:SS 或 +/-DD:MM:SS
- 检查分隔符是否为冒号(:)
- 确认坐标值在有效范围内

#### 3. 目标无法保存
**问题**：添加目标后无法保存配置
**解决**：
- 检查必填字段是否完整
- 确认至少配置了一个滤镜
- 验证目标名称是否重复

#### 4. 模板加载失败
**问题**：选择模板后没有反应
**解决**：
- 重启配置编辑器
- 检查程序权限
- 手动创建基础配置

### 错误处理
配置编辑器提供了详细的错误提示：
- **输入错误**：红色边框显示
- **验证失败**：弹出错误对话框
- **文件错误**：状态栏显示错误信息

## 最佳实践

### 配置创建流程
1. **规划观测计划**：确定观测目标和时间
2. **选择合适模板**：根据观测类型选择模板
3. **配置基本信息**：设置服务器和观测站信息
4. **添加观测目标**：逐个添加目标天体
5. **设置观测参数**：调整滤镜和曝光设置
6. **验证配置**：使用验证功能检查错误
7. **保存配置**：保存到文件供后续使用

### 配置管理建议
- **版本控制**：使用Git管理配置文件
- **备份策略**：定期备份重要配置
- **命名规范**：使用描述性的文件名
- **文档记录**：为复杂配置添加注释

### 性能优化
- **目标数量**：单个配置文件不超过20个目标
- **滤镜配置**：合理设置曝光时间和数量
- **时间规划**：避免观测时间冲突

## 更新日志

### v1.0.0 (2025-01)
- ✨ 初始版本发布
- ✨ 多标签页界面设计
- ✨ 图形化目标管理
- ✨ 配置验证功能
- ✨ 模板系统
- ✨ 文件操作支持

## 技术支持

如遇到问题或有功能建议，请通过以下方式联系：
- 提交Issue到项目仓库
- 查看项目文档和Wiki
- 参考示例配置和模板

---

**注意**：配置编辑器是ACPClient项目的一部分，建议与主程序配套使用以获得最佳体验。