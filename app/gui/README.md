# ACPClient GUI 使用指南

## 概述

ACPClient GUI 是一个为天文观测系统设计的现代化图形界面应用程序。它提供了直观的用户界面来管理多目标观测任务、配置参数、监控系统状态和查看日志。

## 功能特性

### 🎯 主要功能
- **多目标观测管理**: 可视化管理和调度多个观测目标
- **配置管理**: 图形化编辑和验证YAML配置文件
- **实时监控**: 实时显示天文台状态和观测进度
- **日志系统**: 详细的运行日志和错误追踪
- **主题支持**: 多种界面主题可选（亮色、暗色、蓝色）

### 📊 界面组件
- **观测控制面板**: 开始/停止观测，选择观测模式
- **状态监控**: 实时显示天文台设备状态
- **目标列表**: 管理和查看观测目标
- **配置编辑器**: 图形化编辑配置文件
- **日志面板**: 实时显示系统日志

## 快速开始

### 1. 安装依赖

```bash
# 安装GUI相关依赖
pip install -r requirements-gui.txt

# 或者手动安装
pip install PyYAML
```

### 2. 启动GUI

```bash
# 基本启动
cd app
python gui_launcher.py

# 指定配置文件
python gui_launcher.py -c multi_target_config.yaml

# 选择主题
python gui_launcher.py -t dark  # 可选: light, dark, blue

# 调试模式
python gui_launcher.py -d
```

### 3. 直接启动主GUI

```bash
cd app
python gui/main_gui.py
```

## 界面使用说明

### 🎛️ 观测控制面板

1. **观测模式选择**
   - 正常观测：执行实际观测任务
   - DRYRUN模式：模拟观测过程，不实际操作设备

2. **观测选项**
   - 仅验证配置：验证配置文件和目标有效性
   - 显示摘要：显示观测计划和调度摘要

3. **控制按钮**
   - 开始观测：启动观测序列
   - 停止观测：中断正在进行的观测

### 📈 状态监控

- **天文台状态**：显示连接状态、设备状态、坐标信息
- **目标列表**：显示所有配置的目标及其状态
- **实时更新**：自动刷新状态信息

### ⚙️ 配置管理

1. **配置文件编辑**
   - 直接在文本编辑器中修改YAML配置
   - 支持语法高亮和格式验证

2. **配置操作**
   - 加载配置：重新加载配置文件
   - 保存配置：保存修改到文件
   - 验证配置：检查配置格式和参数有效性

### 📋 日志查看

- **实时日志**：显示系统运行日志
- **日志级别**：支持不同级别的日志信息
- **日志操作**：清空日志、保存日志到文件

## 配置文件格式

GUI使用与命令行版本相同的YAML配置文件格式：

```yaml
schedule:
  stop_time: '2025-11-29 02:00:00'

acp_server:
  url: 'http://your-server:port'
  username: 'your-username'
  password: 'your-password'

targets:
  - name: 'NGC 1499'
    ra: '04:01:07.51'
    dec: '+36:31:11.9'
    start_time: '2025-11-28 14:17:00'
    priority: 1
    filters:
      - filter_id: 4
        name: 'H-alpha'
        exposure: 600
        count: 20
        binning: 1

meridian_flip:
  stop_minutes_before: 10
  resume_minutes_after: 10
  safety_margin: 5

observatory:
  latitude: 39.9
  longitude: 116.4

global_settings:
  dither: 5
  auto_focus: true
  af_interval: 120
  dryrun: false
```

## 高级功能

### 🎨 主题定制

GUI支持三种内置主题：
- **亮色主题** (light)：经典白色界面
- **暗色主题** (dark)：深色护眼界面
- **蓝色主题** (blue)：专业蓝色界面

### 🔧 自定义组件

GUI模块提供了可重用的组件：
- `StatusBar`: 状态栏组件
- `LogPanel`: 日志面板组件
- `ProgressPanel`: 进度面板组件
- `TargetTree`: 目标树形视图
- `ObservatoryStatusPanel`: 天文台状态面板
- `ConfigEditor`: 配置编辑器

### 🚀 扩展开发

GUI采用模块化设计，易于扩展：
1. 在`gui/`目录下添加新的组件模块
2. 继承现有组件或创建新的界面元素
3. 在主界面中集成新功能

## 故障排除

### 常见问题

1. **无法启动GUI**
   - 检查Python版本（需要Python 3.6+）
   - 确保安装了所有依赖项
   - 检查配置文件路径是否正确

2. **配置文件加载失败**
   - 验证YAML文件格式是否正确
   - 检查文件编码（建议使用UTF-8）
   - 确保所有必需字段都存在

3. **观测无法开始**
   - 检查网络连接是否正常
   - 验证ACP服务器配置是否正确
   - 查看日志了解详细错误信息

4. **界面显示异常**
   - 尝试切换不同的主题
   - 检查屏幕分辨率是否合适
   - 重启应用程序

### 调试模式

使用调试模式启动可以获得更多日志信息：
```bash
python gui_launcher.py -d
```

## 最佳实践

### 📋 使用建议

1. **配置管理**
   - 定期备份配置文件
   - 使用版本控制管理配置变更
   - 在修改配置前先验证格式

2. **观测计划**
   - 提前验证目标的可观测性
   - 合理安排观测顺序和时间
   - 监控天气变化和设备状态

3. **日志管理**
   - 定期清理旧的日志文件
   - 重要观测任务保存日志副本
   - 分析日志优化观测策略

### 🔒 安全提示

- 不要在配置文件中存储敏感信息
- 定期更新密码和访问凭据
- 使用安全的网络连接
- 限制对配置文件的访问权限

## 技术支持

如遇到问题或有功能建议，请：
1. 查看应用程序日志了解详细信息
2. 检查配置文件格式和参数
3. 参考项目文档和示例配置
4. 在项目中提交Issue或建议

---

**注意**: GUI界面与命令行版本功能完全兼容，可以无缝切换使用。